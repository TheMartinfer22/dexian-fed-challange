<app-header></app-header>
<div class="flex justify-center md:mt-20 items-center mb-10 md:mb-0">
  <div class="md:block flex flex-col  md:h-fit p-10 md:w-1/2 w-screen">
    <div>
      <h1 class="text-3xl">Escolas cadastradas</h1>
      <h1 class="text-xl font-light">Aqui você pode administrar as escolas do sistema.</h1>
      <div class="mt-2">
        <span class="p-input-icon-right md:w-[50%] w-full">
            <i class="pi pi-search"></i>
            <input [(ngModel)]="pesquisarEscolas" (input)="verificarResultados()" type="text" class="p-2 w-full rounded-2xl pe-20" pInputText placeholder="Pesquise uma escola..."/>
        </span>
      </div>
    </div>
    <div class="mt-4">
      <p-button icon="pi pi-plus" (click)="cadastrarEscolaDialog()"  class="text-green-700 font-bold" label="Cadastrar Escola"></p-button>
    </div>
    <div *ngIf="mostrarMensagemNenhumResultado" class="mt-4 w-fit">
      <p class="font-bold text-xl">Nenhum resultado foi encontrado...</p>
    </div>
    <p-dataView [value]="escolas" *ngIf="!mostrarMensagemNenhumResultado">
      <ng-template pTemplate="list">
        <div class="md:border-none border-[1px] border-b-black grid md:grid-cols-12 gap-4 border-t border-gray-200 p-4 bg-dexian-purple-light" *ngFor="let escola of escolas | filterEscola: pesquisarEscolas">
          <div class="md:flex hidden justify-center items-center">
            <p-avatar [label]="escola.sDescricao.at(0)" size="xlarge" [style]="{ 'background-color': '#2196F3', color: '#ffffff' }"></p-avatar>
          </div>
          <div class="col-span-9 flex flex-col justify-between font-bold">
            <div class="flex flex-col sm:flex-row gap-3 p-1">
              <div>
                <span>Identificação: </span>
                <span *ngIf="!escola.editando" class="font-medium">{{ escola.iCodEscola }}</span>
                <input pInputText *ngIf="escola.editando" [(ngModel)]="escola.iCodEscola" type="number" class="font-medium p-1 rounded-xl">
              </div>
              <div class="flex gap-2">
                <span>Descrição: </span>
                <span *ngIf="!escola.editando" class="font-medium">{{ escola.sDescricao }}</span>
                <input pInputText *ngIf="escola.editando" [(ngModel)]="escola.sDescricao" type="text" class="font-medium p-1 rounded-xl">
              </div>
            </div>
            <div class="flex gap-2 p-2">
              <p-button *ngIf="!escola.editando" (click)="editarEscola(escola)"  class="me-3 text-yellow-700" icon="pi pi-pencil" label="Alterar"></p-button>
              <p-button *ngIf="!escola.editando"  (click)="deleteEscolaConfirm($event, escola)" class="text-red-700" icon="pi pi-trash" label="Excluir"></p-button>
              <div *ngIf="escola.editando">
                <p-button (click)="salvarEscola(escola)" class="me-3 text-green-700" icon="pi pi-check" label="Salvar"></p-button>
                <p-button (click)="cancelarEdicao(escola)" class="text-red-700" icon="pi pi-times" label="Cancelar"></p-button>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </p-dataView>
  </div>
</div>
<app-menu></app-menu>
<p-toast />
<p-confirmDialog />

<p-dialog
  header="Cadastrar Escola"
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '25rem' }">
  <form (ngSubmit)="cadastrarEscola()" #form="ngForm">
    <span class="p-text-secondary block mb-5">Preencha as informações da escola.</span>
    <div class="pb-10">
      <div class="flex align-items-center gap-3 mb-5">
        <label for="codEscola" class="font-semibold w-6rem">Código da Escola</label>
        <input pInputText id="codEscola" class="flex-auto" [(ngModel)]="novaEscola.iCodEscola" name="codEscola" type="number" autocomplete="off" required />
      </div>
      <div class="flex align-items-center gap-3 mb-3">
        <label for="descricao" class="font-semibold w-6rem">Descrição</label>
        <input pInputText id="descricao" class="flex-auto" [(ngModel)]="novaEscola.sDescricao" name="descricao" autocomplete="off" required />
      </div>
    </div>
    <div>
      <p-button
        label="Cancelar"
        [text]="true"
        class="bg-red-700 pe-4 ps-4 pt-3 pb-3 text-white rounded-xl me-2"
        severity="secondary"
        (click)="fecharDialog()" />
      <p-button
        type="submit"
        label="Salvar"
        class="bg-green-700 pe-4 ps-4 pt-3 pb-3 text-white rounded-xl"
        [outlined]="true"
        severity="secondary"
        [disabled]="!form.valid" />
    </div>
  </form>
</p-dialog>
